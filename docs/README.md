# FR Arm ROS2 Workspace

MyActuator RMD λ¨ν„° κΈ°λ° FR Arm λ΅λ΄‡μ„ μ„ν• ROS2 μ›ν¬μ¤νμ΄μ¤μ…λ‹λ‹¤.

## π—οΈ μ•„ν‚¤ν…μ² κ°μ”

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                        MoveIt2                                  β”‚
β”‚                   (λ¨μ… ν”λλ‹ & μ‹¤ν–‰)                            β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                      ros2_control                               β”‚
β”‚              (μ»¨νΈλ΅¤λ¬ λ§¤λ‹μ € & ν•λ“μ›¨μ–΄ μ¶”μƒν™”)                    β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚   Mock Hardware    β”‚  MyActuator HW     β”‚   Gazebo Sim          β”‚
β”‚   (Fake μ‹λ®¬λ μ΄μ…)  β”‚  (μ‹¤μ  ν•λ“μ›¨μ–΄)    β”‚   (λ¬Όλ¦¬ μ‹λ®¬λ μ΄μ…)     β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                    myactuator_rmd                               β”‚
β”‚                   (CAN λ“λΌμ΄λ²„ λΌμ΄λΈλ¬λ¦¬)                        β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                   CAN Bus (SocketCAN)                           β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚              MyActuator RMD Motors (x5)                         β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

## π“¦ ν¨ν‚¤μ§€ λ©λ΅

| ν¨ν‚¤μ§€ | μ„¤λ… | μ—­ν•  |
|--------|------|------|
| [`fr_arm_description`](./fr_arm_description/) | URDF/Xacro λ¨λΈ | λ΅λ΄‡ κΈ°κµ¬ν•™ μ •μ |
| [`fr_arm_moveit_config`](./fr_arm_moveit_config/) | MoveIt2 μ„¤μ • | λ¨μ… ν”λλ‹ & λ°μΉνμΌ |
| [`myactuator_hardware`](./myactuator_hardware/) | ν•λ“μ›¨μ–΄ μΈν„°νμ΄μ¤ | ros2_control ν”λ¬κ·ΈμΈ |
| [`myactuator_rmd`](./myactuator_rmd/) | CAN λ“λΌμ΄λ²„ | λ¨ν„° ν†µμ‹  λΌμ΄λΈλ¬λ¦¬ |

## π› οΈ μ„¤μΉ

### μμ΅΄μ„± μ„¤μΉ

```bash
# ROS2 Humble
sudo apt install ros-humble-desktop

# MoveIt2
sudo apt install ros-humble-moveit

# ros2_control
sudo apt install ros-humble-ros2-control ros-humble-ros2-controllers

# μ¶”κ°€ μμ΅΄μ„±
sudo apt install ros-humble-xacro ros-humble-joint-state-publisher-gui
```

### λΉλ“

```bash
cd ~/colcon_ws
colcon build --symlink-install
source install/setup.bash
```

## π€ λΉ λ¥Έ μ‹μ‘

### 1. Fake Hardware λ°λ¨

μ‹¤μ  ν•λ“μ›¨μ–΄ μ—†μ΄ MoveIt ν…μ¤νΈ:

```bash
ros2 launch fr_arm_moveit_config demo.launch.py
```

RVizμ—μ„ MotionPlanning ν¨λ„μ„ μ‚¬μ©ν•μ—¬ λ΅λ΄‡μ„ μ›€μ§μΌ μ μμµλ‹λ‹¤.

### 2. μ‹¤μ  ν•λ“μ›¨μ–΄

```bash
# CAN μΈν„°νμ΄μ¤ μ„¤μ •
sudo ip link set can0 type can bitrate 1000000
sudo ip link set can0 up

# ν•λ“μ›¨μ–΄ λ°μΉ
ros2 launch fr_arm_moveit_config hardware.launch.py can_interface:=can0
```

### 3. Gazebo μ‹λ®¬λ μ΄μ…

```bash
ros2 launch fr_arm_moveit_config gazebo_moveit.launch.py
```

## π¤– λ΅λ΄‡ μ‚¬μ–‘

### ν•λ“μ›¨μ–΄ κµ¬μ„±

FR Armμ€ **λ‘ κ°€μ§€ νƒ€μ…μ λ¨ν„°**λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤:

| λ¨ν„° νƒ€μ… | ν†µμ‹  | κ°μ | μ©λ„ | ν„μ¬ μƒνƒ |
|----------|------|------|------|----------|
| MyActuator RMD | CAN | 4κ° | ν” μ΅°μΈνΈ | β… μ§€μ› |
| Dynamixel | Serial | 1κ° | κ·Έλ¦¬νΌ | β³ Fake Hardware |

### μ΅°μΈνΈ κµ¬μ„±

| μ΅°μΈνΈ | λ¨ν„° νƒ€μ… | λ¨ν„° ID | λ²”μ„ | μ©λ„ |
|--------|----------|---------|------|------|
| link2_to_link1 | MyActuator | 1 | -180Β° ~ 180Β° | λ² μ΄μ¤ νμ „ |
| link3_to_link2 | MyActuator | 2 | -180Β° ~ 180Β° | μ–΄κΉ¨ 1 |
| link4_to_link3 | MyActuator | 3 | -180Β° ~ 180Β° | μ–΄κΉ¨ 2 |
| gripper_to_link4 | MyActuator | 4 | -180Β° ~ 180Β° | ν”κΏμΉ |
| gripper_left_joint | Dynamixel | - | 0 ~ 0.04m | κ·Έλ¦¬νΌ |

### λ¨ν„° μ„¤μ •

| λ¨ν„° ID | Kt (ν† ν¬ μƒμ) | μ©λ„ |
|---------|----------------|------|
| 1-4 | 0.32 | ν” μ΅°μΈνΈ (MyActuator) |

## π“΅ CAN ν†µμ‹ 

### ν•λ“μ›¨μ–΄ μ—°κ²°

```
PC (USB-CAN) β”€β”€β”€ CAN_H β”€β”€β”€ Motor 1 β”€β”€β”€ Motor 2 β”€β”€β”€ Motor 3 β”€β”€β”€ Motor 4
              β””β”€β”€ CAN_L β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
              β””β”€β”€ GND β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                                                        β””β”€β”€ 120Ξ© (μΆ…λ‹¨μ €ν•­)

PC (USB2Dynamixel) β”€β”€β”€ Gripper Motor (λ³„λ„ μ—°κ²°, ν„μ¬ Fake Hardware)
```

### CAN μ„¤μ • λ…λ Ήμ–΄

```bash
# μ‹¤μ  CAN μ–΄λ‘ν„°
sudo ip link set can0 type can bitrate 1000000
sudo ip link set can0 up

# μ—°κ²° ν…μ¤νΈ
ros2 launch myactuator_hardware test_connection.launch.py can_interface:=can0

# κ°€μƒ CAN (ν…μ¤νΈμ©)
sudo modprobe vcan
sudo ip link add dev vcan0 type vcan
sudo ip link set vcan0 up

# μƒνƒ ν™•μΈ
ip link show can0
candump can0  # CAN λ©”μ‹μ§€ λ¨λ‹ν„°λ§
```

## π”§ λ¬Έμ  ν•΄κ²°

### CAN μΈν„°νμ΄μ¤λ¥Ό μ°Ύμ„ μ μ—†μ

```
β•”β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•—
β•‘  CAN INTERFACE NOT FOUND                                     β•‘
β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•
```

**ν•΄κ²°μ±…:**
1. CAN μ–΄λ‘ν„°κ°€ μ—°κ²°λμ–΄ μλ”μ§€ ν™•μΈ
2. `ip link show` λ΅ μΈν„°νμ΄μ¤ ν™•μΈ
3. `sudo ip link set can0 up` μΌλ΅ ν™μ„±ν™”

### λ¨ν„° μ—°κ²° μ‹¤ν¨

```
β•”β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•—
β•‘  MOTOR CONNECTION FAILED                                     β•‘
β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•
```

**μ²΄ν¬λ¦¬μ¤νΈ:**
- β–΅ λ¨ν„° μ „μ› ON
- β–΅ CAN λ°°μ„  ν™•μΈ (CAN_H, CAN_L, GND)
- β–΅ λ¨ν„° IDκ°€ μ„¤μ •κ³Ό μΌμΉ
- β–΅ CAN bitrate μΌμΉ (1Mbps)
- β–΅ 120Ξ© μΆ…λ‹¨ μ €ν•­ μ„¤μΉ

## π“‚ λ””λ ‰ν† λ¦¬ κµ¬μ΅°

```
colcon_ws/
β”β”€β”€ src/
β”‚   β”β”€β”€ fr_arm_description/      # λ΅λ΄‡ λ¨λΈ
β”‚   β”β”€β”€ fr_arm_moveit_config/    # MoveIt μ„¤μ •
β”‚   β”β”€β”€ myactuator_hardware/     # ν•λ“μ›¨μ–΄ μΈν„°νμ΄μ¤
β”‚   β””β”€β”€ myactuator_rmd/          # CAN λ“λΌμ΄λ²„
β”β”€β”€ build/                       # λΉλ“ μ¶λ ¥
β”β”€β”€ install/                     # μ„¤μΉ νμΌ
β””β”€β”€ log/                         # λΉλ“ λ΅κ·Έ
```

## π“„ λΌμ΄μ„ μ¤

- `fr_arm_description`: MIT
- `fr_arm_moveit_config`: BSD
- `myactuator_hardware`: MIT
- `myactuator_rmd`: MIT

## π¤ κΈ°μ—¬

λ²„κ·Έ λ¦¬ν¬νΈ, κΈ°λ¥ μ”μ²­, Pull Requestλ¥Ό ν™μν•©λ‹λ‹¤!

---

**FR Lab** | ROS2 Humble | Ubuntu 22.04
